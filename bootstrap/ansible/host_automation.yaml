---
- name: Playbook to run commands on the bastion host
  hosts: all
  tasks:
    - name: Run any command on bastion
      ansible.builtin.shell: |
        source .bashrc
        login_hub
        oc get node 
        exit 0
      args:
        executable: /bin/bash
      register: output

    - name: Print all output
      debug:
        var: output

    - name: assign output to variable
      set_fact:
        myvalue: "{{ output.stdout_lines }}"

    - name: Print myvalue
      debug:   
        var: myvalue
    
    - name: Print only first node line
      debug:
        var: myvalue[1]

    - name: Print only nodename
      set_fact:
        node_name: '{{ myvalue[1] | regex_search("^\S*") }}'

    - name: Print only nodename
      debug:
        var: node_name
    
    - name: use oc comands with extracted nodename
      ansible.builtin.shell: |
        oc describe node "{{ node_name }}" 
        exit 0
      args:
        executable: /bin/bash
      register: describe_out

    - name: Print describe output
      debug:
        var: describe_out.stdout_lines
